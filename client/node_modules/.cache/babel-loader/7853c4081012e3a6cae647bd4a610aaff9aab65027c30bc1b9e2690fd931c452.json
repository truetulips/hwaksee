{"ast":null,"code":"import{useNavigate}from'react-router-dom';import axios from'../api/axios';import styles from'../css/Posts.module.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PostList(_ref){let{posts,currentUserId,userRole,onRefresh}=_ref;const navigate=useNavigate();const token=localStorage.getItem('token');// ‚úÖ Í∏Ä ÏÇ≠Ï†ú\nconst handleDelete=async id=>{if(!window.confirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))return;try{await axios.delete(\"/posts/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)}});onRefresh();}catch(err){alert('ÏÇ≠Ï†ú Ïã§Ìå®');}};// ‚úÖ Îß§Ïπ≠ Ï≤òÎ¶¨\nconst handleMatch=async id=>{try{await axios.patch(\"/posts/\".concat(id),{matcher:currentUserId},{headers:{Authorization:\"Bearer \".concat(token)}});onRefresh();}catch(err){alert('Îß§Ïπ≠ Ïã§Ìå®');}};// ‚úÖ Îπà Î¶¨Ïä§Ìä∏ Ï≤òÎ¶¨\nif(!posts||posts.length===0){return/*#__PURE__*/_jsx(\"p\",{className:styles.empty,children:\"\\uD45C\\uC2DC\\uD560 \\uB9E4\\uCE6D\\uAE00\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"});}return/*#__PURE__*/_jsx(\"div\",{className:styles.grid,children:posts.map(post=>{const isAuthor=post.author===currentUserId;const isAdmin=userRole==='admin';const isMatched=!!post.matcher;const isDeletable=!isMatched&&(isAuthor||isAdmin);const canMatch=!isMatched&&!isAuthor&&userRole==='user';// ‚úÖ ÏÉÅÌÉú ÌÖçÏä§Ìä∏ Î∞è ÏÉâÏÉÅ Í≤∞Ï†ï\nlet statusText='Îì±Î°ù Ï§ë';let statusClass=styles.waiting;if(post.status==='Îß§Ïπ≠'){statusText='Í±∞Îûò ÏßÑÌñâ Ï§ë >>';statusClass=styles.active;}else if(post.status==='ÏôÑÎ£å'){statusText='Í±∞Îûò ÏôÑÎ£å';statusClass=styles.done;}return/*#__PURE__*/_jsxs(\"div\",{className:styles.card,onClick:()=>navigate(\"/posts/\".concat(post._id)),children:[isDeletable&&/*#__PURE__*/_jsx(\"button\",{className:styles.deleteButton,onClick:e=>{e.stopPropagation();handleDelete(post._id);},children:\"\\u274C\"}),/*#__PURE__*/_jsx(\"h3\",{className:styles.postT,children:post.title}),/*#__PURE__*/_jsxs(\"p\",{children:[post.price.toLocaleString(),\"\\uC6D0\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"\".concat(styles.status,\" \").concat(statusClass),children:statusText}),canMatch&&/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();handleMatch(post._id);},children:[/*#__PURE__*/_jsx(\"i\",{className:styles.matchButton}),\"\\uB9E4\\uCE6D\\uD558\\uAE30\"]})]},post._id);})});}","map":{"version":3,"names":["useNavigate","axios","styles","jsx","_jsx","jsxs","_jsxs","PostList","_ref","posts","currentUserId","userRole","onRefresh","navigate","token","localStorage","getItem","handleDelete","id","window","confirm","delete","concat","headers","Authorization","err","alert","handleMatch","patch","matcher","length","className","empty","children","grid","map","post","isAuthor","author","isAdmin","isMatched","isDeletable","canMatch","statusText","statusClass","waiting","status","active","done","card","onClick","_id","deleteButton","e","stopPropagation","postT","title","price","toLocaleString","matchButton"],"sources":["D:/creative/react/hwaksee/client/src/components/PostList.jsx"],"sourcesContent":["import { useNavigate } from 'react-router-dom';\r\nimport axios from '../api/axios';\r\nimport styles from '../css/Posts.module.css';\r\n\r\nexport default function PostList({ posts, currentUserId, userRole, onRefresh }) {\r\n  const navigate = useNavigate();\r\n  const token = localStorage.getItem('token');\r\n\r\n  // ‚úÖ Í∏Ä ÏÇ≠Ï†ú\r\n  const handleDelete = async (id) => {\r\n    if (!window.confirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;\r\n    try {\r\n      await axios.delete(`/posts/${id}`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      onRefresh();\r\n    } catch (err) {\r\n      alert('ÏÇ≠Ï†ú Ïã§Ìå®');\r\n    }\r\n  };\r\n\r\n  // ‚úÖ Îß§Ïπ≠ Ï≤òÎ¶¨\r\n  const handleMatch = async (id) => {\r\n    try {\r\n      await axios.patch(`/posts/${id}`, { matcher: currentUserId }, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      onRefresh();\r\n    } catch (err) {\r\n      alert('Îß§Ïπ≠ Ïã§Ìå®');\r\n    }\r\n  };\r\n\r\n  // ‚úÖ Îπà Î¶¨Ïä§Ìä∏ Ï≤òÎ¶¨\r\n  if (!posts || posts.length === 0) {\r\n    return <p className={styles.empty}>ÌëúÏãúÌï† Îß§Ïπ≠Í∏ÄÏù¥ ÏóÜÏäµÎãàÎã§.</p>;\r\n  }\r\n\r\n  return (\r\n    <div className={styles.grid}>\r\n      {posts.map(post => {\r\n        const isAuthor = post.author === currentUserId;\r\n        const isAdmin = userRole === 'admin';\r\n        const isMatched = !!post.matcher;\r\n\r\n        const isDeletable = !isMatched && (isAuthor || isAdmin);\r\n        const canMatch = !isMatched && !isAuthor && userRole === 'user';\r\n\r\n        // ‚úÖ ÏÉÅÌÉú ÌÖçÏä§Ìä∏ Î∞è ÏÉâÏÉÅ Í≤∞Ï†ï\r\n        let statusText = 'Îì±Î°ù Ï§ë';\r\n        let statusClass = styles.waiting;\r\n\r\n        if (post.status === 'Îß§Ïπ≠') {\r\n          statusText = 'Í±∞Îûò ÏßÑÌñâ Ï§ë >>';\r\n          statusClass = styles.active;\r\n        } else if (post.status === 'ÏôÑÎ£å') {\r\n          statusText = 'Í±∞Îûò ÏôÑÎ£å';\r\n          statusClass = styles.done;\r\n        }\r\n\r\n        return (\r\n          <div\r\n            key={post._id}\r\n            className={styles.card}\r\n            onClick={() => navigate(`/posts/${post._id}`)}\r\n          >\r\n            {/* ‚ùå ÏÇ≠Ï†ú Î≤ÑÌäº */}\r\n            {isDeletable && (\r\n              <button\r\n                className={styles.deleteButton}\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  handleDelete(post._id);\r\n                }}\r\n              >\r\n                ‚ùå\r\n              </button>\r\n            )}\r\n\r\n            {/* üìÑ Í∏Ä Ï†ïÎ≥¥ */}\r\n            <h3 className={styles.postT}>{post.title}</h3>\r\n            <p>{post.price.toLocaleString()}Ïõê</p>\r\n            <p className={`${styles.status} ${statusClass}`}>{statusText}</p>\r\n\r\n            {/* ü§ù Îß§Ïπ≠ Î≤ÑÌäº */}\r\n            {canMatch && (\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  handleMatch(post._id);\r\n                }}\r\n              >\r\n                <i className={styles.matchButton}></i>Îß§Ïπ≠ÌïòÍ∏∞\r\n              </button>\r\n            )}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}