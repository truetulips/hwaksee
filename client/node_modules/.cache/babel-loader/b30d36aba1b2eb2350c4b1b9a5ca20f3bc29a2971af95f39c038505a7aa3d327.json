{"ast":null,"code":"import{useState}from'react';import styles from'../css/Posts.module.css';import TrackingStatus from'./TrackingStatus';import imageLibrary from'../data/images';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function BuyerActions(_ref){let{post,updatePost}=_ref;const[paymentMethod,setPaymentMethod]=useState(post.paymentMethod||'');const[trackingInfo,setTrackingInfo]=useState(null);const{buyerStatus,inspectionResult,shipping}=post;// ✅ 상태 분기\nconst canRequestDeposit=!buyerStatus||buyerStatus==='진행 전';const isWaitingForInspection=['입금확인','물품확인'].includes(buyerStatus)&&inspectionResult===null;const canDecisionOnInspection=buyerStatus==='물품확인'&&inspectionResult!==null;const canTrackShipping=buyerStatus==='출고'&&(shipping===null||shipping===void 0?void 0:shipping.courier)&&(shipping===null||shipping===void 0?void 0:shipping.tracking);const canFinalize=buyerStatus==='출고';// ✅ 현금 입금 처리\nconst handleDepositRequest=()=>{if(!paymentMethod){alert('결제 방식을 선택해주세요.');return;}updatePost({buyerStatus:'입금',paymentMethod:'cash'});};// ✅ 구매 / 취소 결정\nconst handlePurchaseConfirm=()=>updatePost({buyerStatus:'구매'});const handleCancelPurchase=()=>updatePost({buyerStatus:'취소'});// ✅ 거래 완료\nconst handleFinalize=()=>updatePost({buyerStatus:'완료'});// ✅ 배송 추적\nconst fetchTracking=async()=>{try{const res=await fetch(\"/tracking?code=\".concat(shipping.courier,\"&invoice=\").concat(shipping.tracking));const data=await res.json();setTrackingInfo(data);}catch(err){alert('배송 추적 실패: '+(err.message||'API 오류'));}};return/*#__PURE__*/_jsxs(\"div\",{className:styles.actionBox,children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\uD83E\\uDDFE \\uAD6C\\uB9E4\\uC790\"}),canRequestDeposit&&/*#__PURE__*/_jsxs(_Fragment,{children:[paymentMethod==='cash'&&/*#__PURE__*/_jsxs(\"div\",{className:styles.notice,children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"img\",{src:imageLibrary.find(img=>img.id===2).src,alt:imageLibrary.find(img=>img.id===2).alt,className:styles.notiBank}),/*#__PURE__*/_jsx(\"span\",{onClick:()=>{navigator.clipboard.writeText(\"100041715312\");alert('📋 입금계좌가 복사되었습니다');},children:\" 1000-4171-5312\"}),\" \\uC774\\uD604\"]}),/*#__PURE__*/_jsxs(\"p\",{style:{color:\"#d65c5cff\",marginLeft:\"16px\",marginBottom:\"5px\"},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:\"12px\"},children:\"\\uD83D\\uDCCC\"}),\"\\uC785\\uAE08 \\uD6C4 \\\"\\uC785\\uAE08\\uC644\\uB8CC\\\"\\uB97C \\uAF2D \\uB20C\\uB7EC\\uC8FC\\uC138\\uC694!\"]}),' ',/*#__PURE__*/_jsx(\"button\",{onClick:handleDepositRequest,className:styles.confirmBtn,children:\"\\uC785\\uAE08\\uC644\\uB8CC\"})]}),post.paymentMethod==='pay'&&post.smartstoreProductId&&/*#__PURE__*/_jsx(\"a\",{href:\"https://smartstore.naver.com/grinform/products/\".concat(post.smartstoreProductId),target:\"_blank\",rel:\"noopener noreferrer\",className:styles.confirmBtn,children:\"\\uACB0\\uC81C\\uD558\\uAE30\"})]}),isWaitingForInspection&&/*#__PURE__*/_jsx(\"div\",{className:styles.notice,children:\"\\u23F3 \\uAD00\\uB9AC\\uC790\\uAC00 \\uBB3C\\uD488\\uC744 \\uD655\\uC778 \\uC911\\uC785\\uB2C8\\uB2E4.\"}),canDecisionOnInspection&&/*#__PURE__*/_jsxs(\"div\",{className:styles.notice,children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDD0D \\uAD00\\uB9AC\\uC790 \\uAC80\\uC0AC \\uACB0\\uACFC: \",/*#__PURE__*/_jsx(\"strong\",{children:inspectionResult})]}),post.inspectionDescription&&/*#__PURE__*/_jsxs(\"p\",{className:styles.descriptionBox,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uC124\\uBA85:\"}),\" \",post.inspectionDescription,\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:styles.small_noti,children:\" \\u25A0 \\uD310\\uB9E4\\uC790\\uC640 \\uC5F0\\uB77D\\uC744 \\uAD8C\\uD569\\uB2C8\\uB2E4.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.buttonGroup,children:[/*#__PURE__*/_jsx(\"button\",{onClick:handlePurchaseConfirm,className:styles.confirmBtn,children:\"\\u2705 \\uAD6C\\uB9E4\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelPurchase,className:styles.confirmBtn,children:\"\\u274C \\uCDE8\\uC18C\"})]})]}),canTrackShipping&&/*#__PURE__*/_jsx(\"div\",{className:styles.buttonGroup,children:/*#__PURE__*/_jsx(\"button\",{onClick:fetchTracking,children:\"\\uD83D\\uDD0D \\uBC30\\uC1A1 \\uCD94\\uC801\"})}),trackingInfo&&/*#__PURE__*/_jsx(TrackingStatus,{trackingInfo:trackingInfo}),canFinalize&&/*#__PURE__*/_jsx(\"button\",{onClick:handleFinalize,className:styles.confirmBtn,children:\"\\uD83C\\uDF89 \\uBB3C\\uD488\\uC218\\uB839\"})]});}","map":{"version":3,"names":["useState","styles","TrackingStatus","imageLibrary","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","BuyerActions","_ref","post","updatePost","paymentMethod","setPaymentMethod","trackingInfo","setTrackingInfo","buyerStatus","inspectionResult","shipping","canRequestDeposit","isWaitingForInspection","includes","canDecisionOnInspection","canTrackShipping","courier","tracking","canFinalize","handleDepositRequest","alert","handlePurchaseConfirm","handleCancelPurchase","handleFinalize","fetchTracking","res","fetch","concat","data","json","err","message","className","actionBox","children","notice","src","find","img","id","alt","notiBank","onClick","navigator","clipboard","writeText","style","color","marginLeft","marginBottom","fontSize","confirmBtn","smartstoreProductId","href","target","rel","inspectionDescription","descriptionBox","small_noti","buttonGroup"],"sources":["D:/creative/react/hwaksee/client/src/components/BuyerActions.jsx"],"sourcesContent":["import { useState } from 'react';\r\nimport styles from '../css/Posts.module.css';\r\nimport TrackingStatus from './TrackingStatus';\r\nimport imageLibrary from '../data/images';\r\n\r\nexport default function BuyerActions({ post, updatePost }) {\r\n  const [paymentMethod, setPaymentMethod] = useState(post.paymentMethod || '');\r\n  const [trackingInfo, setTrackingInfo] = useState(null);\r\n\r\n  const { buyerStatus, inspectionResult, shipping } = post;\r\n\r\n  // ✅ 상태 분기\r\n  const canRequestDeposit = !buyerStatus || buyerStatus === '진행 전';\r\n  const isWaitingForInspection = ['입금확인', '물품확인'].includes(buyerStatus) && inspectionResult === null;\r\n  const canDecisionOnInspection = buyerStatus === '물품확인' && inspectionResult !== null;\r\n  const canTrackShipping = buyerStatus === '출고' && shipping?.courier && shipping?.tracking;\r\n  const canFinalize = buyerStatus === '출고';\r\n\r\n  // ✅ 현금 입금 처리\r\n  const handleDepositRequest = () => {\r\n    if (!paymentMethod) {\r\n      alert('결제 방식을 선택해주세요.');\r\n      return;\r\n    }\r\n    updatePost({ buyerStatus: '입금', paymentMethod: 'cash' });\r\n  };\r\n\r\n  // ✅ 구매 / 취소 결정\r\n  const handlePurchaseConfirm = () => updatePost({ buyerStatus: '구매' });\r\n  const handleCancelPurchase = () => updatePost({ buyerStatus: '취소' });\r\n\r\n  // ✅ 거래 완료\r\n  const handleFinalize = () => updatePost({ buyerStatus: '완료' });\r\n\r\n  // ✅ 배송 추적\r\n  const fetchTracking = async () => {\r\n    try {\r\n      const res = await fetch(`/tracking?code=${shipping.courier}&invoice=${shipping.tracking}`);\r\n      const data = await res.json();\r\n      setTrackingInfo(data);\r\n    } catch (err) {\r\n      alert('배송 추적 실패: ' + (err.message || 'API 오류'));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={styles.actionBox}>\r\n      <h4>🧾 구매자</h4>\r\n\r\n      {/* ✅ 결제 방식 선택 및 입금 요청 */}\r\n      {canRequestDeposit && (\r\n        <>\r\n          {/* <select\r\n            value={paymentMethod}\r\n            onChange={e => setPaymentMethod(e.target.value)}\r\n            className={styles.input}\r\n          >\r\n            <option value=\"\">결제 방식 선택</option>\r\n            <option value=\"cash\">현금 입금</option>\r\n            <option value=\"pay\">네이버페이</option>\r\n          </select> */}\r\n\r\n          {paymentMethod === 'cash' && (\r\n            <div className={styles.notice}>\r\n              <p><img\r\n                  src={imageLibrary.find(img => img.id === 2).src}\r\n                  alt={imageLibrary.find(img => img.id === 2).alt}\r\n                  className={styles.notiBank}\r\n                />\r\n                <span onClick={() => {navigator.clipboard.writeText(\"100041715312\");alert('📋 입금계좌가 복사되었습니다');\r\n              }}> 1000-4171-5312</span> 이현\r\n              </p>\r\n              <p style={{ color: \"#d65c5cff\", marginLeft: \"16px\", marginBottom: \"5px\" }}><span style={{ fontSize: \"12px\" }}>📌</span>입금 후 \"입금완료\"를 꼭 눌러주세요!</p>{' '}\r\n              <button onClick={handleDepositRequest} className={styles.confirmBtn}>입금완료</button>\r\n            </div>\r\n          )}\r\n\r\n          {post.paymentMethod === 'pay' && post.smartstoreProductId && (\r\n            <a\r\n              href={`https://smartstore.naver.com/grinform/products/${post.smartstoreProductId}`}\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n              className={styles.confirmBtn}\r\n            >\r\n              결제하기\r\n            </a>\r\n          )}\r\n        </>\r\n      )}\r\n\r\n      {/* ✅ 검사 결과 대기 중 */}\r\n      {isWaitingForInspection && (\r\n        <div className={styles.notice}>\r\n          ⏳ 관리자가 물품을 확인 중입니다.\r\n        </div>\r\n      )}\r\n\r\n      {/* ✅ 검사 결과 기반 구매 결정 */}\r\n      {canDecisionOnInspection && (\r\n        <div className={styles.notice}>\r\n          <p>🔍 관리자 검사 결과: <strong>{inspectionResult}</strong></p>\r\n          {post.inspectionDescription && (\r\n            <p className={styles.descriptionBox}>\r\n              <strong>설명:</strong> {post.inspectionDescription} <br />\r\n              <span className={styles.small_noti}> ■ 판매자와 연락을 권합니다.</span>\r\n            </p>\r\n          )}\r\n          <div className={styles.buttonGroup}>\r\n            <button onClick={handlePurchaseConfirm} className={styles.confirmBtn}>✅ 구매</button>\r\n            <button onClick={handleCancelPurchase} className={styles.confirmBtn}>❌ 취소</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ✅ 배송 추적 */}\r\n      {canTrackShipping && (\r\n        <div className={styles.buttonGroup}>\r\n          <button onClick={fetchTracking}>🔍 배송 추적</button>\r\n        </div>\r\n      )}\r\n\r\n      {/* ✅ 배송 추적 결과 */}\r\n      {trackingInfo && <TrackingStatus trackingInfo={trackingInfo} />}\r\n\r\n      {/* ✅ 거래 완료 */}\r\n      {canFinalize && (\r\n        <button onClick={handleFinalize} className={styles.confirmBtn}>\r\n          🎉 물품수령\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}